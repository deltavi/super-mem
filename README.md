# ![super-mem](docs/super-mem.png) Super Mem [![Build Status](https://travis-ci.org/deltavi/super-mem.svg?branch=master)](https://travis-ci.org/deltavi/super-mem)

Utility to manage Node.js memory

## Install

    npm install super-mem

# API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [memoryUsage](#memoryusage)
    -   [Parameters](#parameters)
    -   [Examples](#examples)
-   [osMemory](#osmemory)
    -   [Parameters](#parameters-1)
    -   [Examples](#examples-1)
-   [sizeOf](#sizeof)
    -   [Parameters](#parameters-2)
    -   [Examples](#examples-2)
-   [printMemoryStatus](#printmemorystatus)
    -   [Parameters](#parameters-3)
    -   [Examples](#examples-3)
-   [HeapObserver](#heapobserver)
    -   [Parameters](#parameters-4)
    -   [Examples](#examples-4)

## memoryUsage

Returns an object describing the memory usage of the Node.js process measured in bytes and human readable format.
Note that it uses base-10.

### Parameters

-   `hrOnly` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?** Human readable format only, default `false`

### Examples

```javascript
{
  "rss": 42360832,
  "heapTotal": 35254272,
  "heapUsed": 16044848,
  "external": 108125,
  "rssHR": "42.4 MB",
  "heapTotalHR": "35.3 MB",
  "heapUsedHR": "16 MB",
  "externalHR": "108 kB"
}
```

## osMemory

Returns an object describing the OS memory measured in bytes and human readable format.
Note that it uses base-10.

### Parameters

-   `hrOnly` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?** Human readable format only, default `false`

### Examples

```javascript
{
    "totalMem": 17073917952,
    "freeMem": 11155980288,
    "totalMemHR": "17.1 GB",
    "freeMemHR": "11.2 GB"
}
```

## sizeOf

Returns the size of the 'inputObject', measured in bytes and human readable format.
Note that it uses base-10.

### Parameters

-   `inputObject` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Object to measure the size
-   `hrOnly` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?** Human readable format only, default `false`

### Examples

```javascript
{
  "size": 20488,
  "sizeHR": "20.5 kB"
}
```

## printMemoryStatus

Print the memory status on console

### Parameters

-   `decorator` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?** Optional string to create header and footer, default `"-"`

### Examples

```javascript
-------------------- Memory Status --------------------
 • Process memory usage:
    rss = 45.7 MB
    heapTotal = 35.8 MB
    heapUsed = 18.7 MB
 • OS memory:
    totalmem = 17.1 GB
    freemem = 11.1 GB
-------------------------------------------------------
```

## HeapObserver

Monitors the heap memory and if the heap used exceeds the `limitPerc`, it notifies this to the handling functions

### Parameters

-   `limitPerc` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Limit exceeded which the handling function is called
-   `interval` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional, time interval between memory reading, default `10000`

### Examples

```javascript
const superMem = require('super-mem');
const heapObserver = new superMem.HeapObserver(80, 5000);
heapObserver.addHandler(function (mem, percentage) {
  console.log('HeapObserver MEM: ' + JSON.stringify(mem, null, 2));
  console.log('HeapObserver PERC: ' + parseInt(percentage) + ' %');
});
heapObserver.start();
```
